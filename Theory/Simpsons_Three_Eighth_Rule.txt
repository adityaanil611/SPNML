# Simpson 3/8 Rule

1. Definition / Concept Overview
	Employs cubic interpolation over triplets of panels; requires the number of subintervals to be a multiple of three.

2. Mathematical Formulae
	Composite rule with n divisible by 3:
	Integral â‰ˆ 3 * h / 8 * [f(x0) + 3 * sum_{k in K1} f(xk) + 3 * sum_{k in K2} f(xk) + 2 * sum_{k in K3} f(xk) + f(xn)],
	where K1 are indices congruent to 1 mod 3, K2 congruent to 2 mod 3, and K3 congruent to 0 mod 3 excluding xn.
	Error is O(h^4).

3. Algorithm / Step-by-Step Procedure
	(i) Choose n such that n mod 3 = 0.
	(ii) Apply 3/8 weighting.
	(iii) Sum contributions and multiply by 3 * h / 8.

4. Advantages
	- Same fourth-order accuracy as Simpson 1/3.
	- Useful when the interval count is a multiple of three.

5. Disadvantages / Limitations
	- Slightly more complex bookkeeping; often no better than 1/3.

6. Applications
	- Combine with Simpson 1/3 to handle interval counts not fitting the even requirement.

7. Implementation Insight (MATLAB / R)
	Implement weights manually; many libraries focus on 1/3, but 3/8 is easy to code.

8. Example
	Apply to the same integrals as Simpson 1/3 with n = 3 m.

9. Comparison (Quadrature Methods)

| Method | Approach | Order | Grid restriction | Pros | Cons | Use |
| ------ | -------- | ----- | ---------------- | ---- | ---- | --- |
| Trapezoidal | Linear segments | 2 | None | Simple, robust, works with noisy data | Low order | Quick rough integrals |
| Simpson 1/3 | Quadratic pieces | 4 | n even | High accuracy for smooth functions | Needs even n, not ideal for highly oscillatory data | Default for smooth functions |
| Simpson 3/8 | Cubic pieces | 4 | n multiple of 3 | Same order as 1/3, flexible when n divisible by 3 | Weight bookkeeping | When n is a multiple of 3 or mixing panels |

When to prefer which?
- Smooth integrands: Simpson 1/3 is the default.
- n multiple of 3: Simpson 3/8 (alone or combined with 1/3).
- Noisy or rough data, or a quick estimate: Trapezoidal.
